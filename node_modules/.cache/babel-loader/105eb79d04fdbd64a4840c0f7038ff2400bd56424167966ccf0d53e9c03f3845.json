{"ast":null,"code":"import React,{useState}from'react';import axios from'axios';import'./App.css';// ตรวจสอบว่ามีไฟล์ App.css อยู่ในโฟลเดอร์ src\nimport{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";function App(){const[message,setMessage]=useState('');const[chatHistory,setChatHistory]=useState([]);// เก็บประวัติการสนทนา\nconst[loading,setLoading]=useState(false);const[error,setError]=useState('');const[aiName]=useState('swchat.kru');// ตรวจสอบให้แน่ใจว่า URL นี้ถูกต้องสำหรับ Backend ของคุณบน Render\n// เช่น 'https://ai-8mi3.onrender.com/chat' หรือชื่อที่คุณตั้งไว้\nconst BACKEND_BASE_URL='https://ai-8mi3.onrender.com';// <--- เปลี่ยน URL นี้ให้เป็น Backend จริงของคุณ!\nconst BACKEND_URL=process.env.NODE_ENV==='production'?`${BACKEND_BASE_URL}/chat`:`http://localhost:3001/chat`;const handleSendMessage=async()=>{if(!message.trim())return;// ไม่ส่งข้อความว่างเปล่า\nconst userMessage={sender:'user',text:message};setChatHistory(prev=>[...prev,userMessage]);// เพิ่มข้อความผู้ใช้เข้าประวัติ\nsetLoading(true);// เริ่ม loading state\nsetError('');// ล้าง error เก่า\nsetMessage('');// ล้าง input box\ntry{const response=await axios.post(BACKEND_URL,{message:userMessage.text});const aiReply=response.data.reply;const aiMessage={sender:aiName,text:aiReply};setChatHistory(prev=>[...prev,aiMessage]);// เพิ่มข้อความ AI เข้าประวัติ\n}catch(err){console.error('Error sending message:',err);let errorMessage='Failed to get response from AI. Please check server or API key.';if(err.response){errorMessage=`Error from server: ${err.response.status} - ${JSON.stringify(err.response.data.error||err.response.data)}`;}else if(err.request){errorMessage=`No response from server. Backend might be down or URL is incorrect. (${err.message})`;}else{errorMessage=`An unexpected error occurred: ${err.message}`;}setError(errorMessage);// ถ้ามี error, อาจจะเพิ่มข้อความ error เข้าไปใน chat history ด้วย (optionally)\nsetChatHistory(prev=>[...prev,{sender:'system',text:`Error: ${errorMessage}`}]);}finally{setLoading(false);// หยุด loading state\n}};const handleKeyPress=e=>{if(e.key==='Enter'&&!e.shiftKey){// กด Enter โดยไม่กด Shift\ne.preventDefault();// ป้องกันการขึ้นบรรทัดใหม่\nhandleSendMessage();}};return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsx(\"header\",{className:\"App-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"chat-window\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"chat-header\",children:/*#__PURE__*/_jsxs(\"h1\",{children:[aiName,\" Chat\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-messages\",children:[chatHistory.length===0&&!loading&&!error&&/*#__PURE__*/_jsx(\"div\",{className:\"welcome-message\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0E2A\\u0E27\\u0E31\\u0E2A\\u0E14\\u0E35\\u0E04\\u0E23\\u0E31\\u0E1A! \\u0E1C\\u0E21\\u0E04\\u0E37\\u0E2D \",aiName,\". \\u0E04\\u0E38\\u0E13\\u0E21\\u0E35\\u0E2D\\u0E30\\u0E44\\u0E23\\u0E43\\u0E2B\\u0E49\\u0E1C\\u0E21\\u0E0A\\u0E48\\u0E27\\u0E22\\u0E44\\u0E2B\\u0E21\\u0E04\\u0E23\\u0E31\\u0E1A?\"]})}),chatHistory.map((msg,index)=>/*#__PURE__*/_jsxs(\"div\",{className:`message-bubble ${msg.sender==='user'?'user':'ai'}`,children:[/*#__PURE__*/_jsxs(\"span\",{className:\"sender-name\",children:[msg.sender==='user'?'คุณ':aiName,\": \"]}),msg.text]},index)),loading&&/*#__PURE__*/_jsxs(\"div\",{className:\"message-bubble ai loading\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"sender-name\",children:[aiName,\": \"]}),\" \\u0E01\\u0E33\\u0E25\\u0E31\\u0E07\\u0E04\\u0E34\\u0E14...\"]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"message-bubble system error\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sender-name\",children:\"System Error: \"}),\" \",error]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-input-area\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:message,onChange:e=>setMessage(e.target.value),onKeyPress:handleKeyPress,placeholder:\"\\u0E1E\\u0E34\\u0E21\\u0E1E\\u0E4C\\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21...\",rows:\"1\"// เริ่มต้นที่ 1 บรรทัด และขยายได้\n,className:\"message-input\",disabled:loading}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSendMessage,disabled:loading||!message.trim(),children:\"\\u0E2A\\u0E48\\u0E07\"})]})]})})});}export default App;","map":{"version":3,"names":["React","useState","axios","jsxs","_jsxs","jsx","_jsx","App","message","setMessage","chatHistory","setChatHistory","loading","setLoading","error","setError","aiName","BACKEND_BASE_URL","BACKEND_URL","process","env","NODE_ENV","handleSendMessage","trim","userMessage","sender","text","prev","response","post","aiReply","data","reply","aiMessage","err","console","errorMessage","status","JSON","stringify","request","handleKeyPress","e","key","shiftKey","preventDefault","className","children","length","map","msg","index","value","onChange","target","onKeyPress","placeholder","rows","disabled","onClick"],"sources":["/workspaces/s-er/src/App.js"],"sourcesContent":["import React, { useState } from 'react';\nimport axios from 'axios';\nimport './App.css'; // ตรวจสอบว่ามีไฟล์ App.css อยู่ในโฟลเดอร์ src\n\nfunction App() {\n    const [message, setMessage] = useState('');\n    const [chatHistory, setChatHistory] = useState([]); // เก็บประวัติการสนทนา\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState('');\n    const [aiName] = useState('swchat.kru');\n\n    // ตรวจสอบให้แน่ใจว่า URL นี้ถูกต้องสำหรับ Backend ของคุณบน Render\n    // เช่น 'https://ai-8mi3.onrender.com/chat' หรือชื่อที่คุณตั้งไว้\n    const BACKEND_BASE_URL = 'https://ai-8mi3.onrender.com'; // <--- เปลี่ยน URL นี้ให้เป็น Backend จริงของคุณ!\n\n    const BACKEND_URL = process.env.NODE_ENV === 'production'\n        ? `${BACKEND_BASE_URL}/chat`\n        : `http://localhost:3001/chat`;\n\n    const handleSendMessage = async () => {\n        if (!message.trim()) return; // ไม่ส่งข้อความว่างเปล่า\n\n        const userMessage = { sender: 'user', text: message };\n        setChatHistory(prev => [...prev, userMessage]); // เพิ่มข้อความผู้ใช้เข้าประวัติ\n\n        setLoading(true); // เริ่ม loading state\n        setError(''); // ล้าง error เก่า\n        setMessage(''); // ล้าง input box\n\n        try {\n            const response = await axios.post(BACKEND_URL, { message: userMessage.text });\n            const aiReply = response.data.reply;\n            const aiMessage = { sender: aiName, text: aiReply };\n            setChatHistory(prev => [...prev, aiMessage]); // เพิ่มข้อความ AI เข้าประวัติ\n\n        } catch (err) {\n            console.error('Error sending message:', err);\n            let errorMessage = 'Failed to get response from AI. Please check server or API key.';\n            if (err.response) {\n                errorMessage = `Error from server: ${err.response.status} - ${JSON.stringify(err.response.data.error || err.response.data)}`;\n            } else if (err.request) {\n                errorMessage = `No response from server. Backend might be down or URL is incorrect. (${err.message})`;\n            } else {\n                errorMessage = `An unexpected error occurred: ${err.message}`;\n            }\n            setError(errorMessage);\n            // ถ้ามี error, อาจจะเพิ่มข้อความ error เข้าไปใน chat history ด้วย (optionally)\n            setChatHistory(prev => [...prev, { sender: 'system', text: `Error: ${errorMessage}` }]);\n        } finally {\n            setLoading(false); // หยุด loading state\n        }\n    };\n\n    const handleKeyPress = (e) => {\n        if (e.key === 'Enter' && !e.shiftKey) { // กด Enter โดยไม่กด Shift\n            e.preventDefault(); // ป้องกันการขึ้นบรรทัดใหม่\n            handleSendMessage();\n        }\n    };\n\n    return (\n        <div className=\"App\">\n            <header className=\"App-header\">\n                <div className=\"chat-window\">\n                    <div className=\"chat-header\">\n                        <h1>{aiName} Chat</h1>\n                    </div>\n                    <div className=\"chat-messages\">\n                        {chatHistory.length === 0 && !loading && !error && (\n                            <div className=\"welcome-message\">\n                                <p>สวัสดีครับ! ผมคือ {aiName}. คุณมีอะไรให้ผมช่วยไหมครับ?</p>\n                            </div>\n                        )}\n                        {chatHistory.map((msg, index) => (\n                            <div key={index} className={`message-bubble ${msg.sender === 'user' ? 'user' : 'ai'}`}>\n                                <span className=\"sender-name\">{msg.sender === 'user' ? 'คุณ' : aiName}: </span>\n                                {msg.text}\n                            </div>\n                        ))}\n                        {loading && (\n                            <div className=\"message-bubble ai loading\">\n                                <span className=\"sender-name\">{aiName}: </span> กำลังคิด...\n                            </div>\n                        )}\n                        {error && (\n                            <div className=\"message-bubble system error\">\n                                <span className=\"sender-name\">System Error: </span> {error}\n                            </div>\n                        )}\n                    </div>\n                    <div className=\"chat-input-area\">\n                        <textarea\n                            value={message}\n                            onChange={(e) => setMessage(e.target.value)}\n                            onKeyPress={handleKeyPress}\n                            placeholder=\"พิมพ์ข้อความ...\"\n                            rows=\"1\" // เริ่มต้นที่ 1 บรรทัด และขยายได้\n                            className=\"message-input\"\n                            disabled={loading}\n                        />\n                        <button onClick={handleSendMessage} disabled={loading || !message.trim()}>\n                            ส่ง\n                        </button>\n                    </div>\n                </div>\n            </header>\n        </div>\n    );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}